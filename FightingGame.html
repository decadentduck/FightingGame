<!DOCTYPE html>
<html>
<head>
    <title>Fighting Game</title>
	<meta charset="utf-8">
	<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
	<script type="text/javascript">
        $(document).ready(function ()
        {
            var canvas = $("#myCanvas");
            var context = canvas.get(0).getContext("2d");

            //game playing bool
            var gamePlaying = false;

            //Character objects
            var Lucina =
                {
                    image: "Images/lucina.png",
                    //image size per frame
                    width: 50,
                    height: 60,
                };
            var Bowser =
                {
                    image: "Images/bowser.png",
                    width: 72,
                    height: 65,
                };
            var Sheik =
                {
                    image: "Images/shiek.png",
                    width: 50,
                    height: 45,
                };
            var Samus =
                {
                    image: "Images/samus.png",
                    width: 50,
                    height: 45,
                };

            //character images
            var lucinaImage = new Image();
            lucinaImage.src = Lucina.image;
            var bowserImage = new Image();
            bowserImage.src = Bowser.image;
            var sheikImage = new Image();
            sheikImage.src = Sheik.image;
            var samusImage = new Image();
            samusImage.src = Samus.image;
            
            //background image
            var background = new Image();
            background.src = "Images/Background.png";
            background.addEventListener("load", render, false);
            
            //player object
            var player =
                {
                    idle: 0,
                    block: 0,
                    grab: 1,
                    attack: 2,
                    hurt: 3,
                    dead: 4,
                    jump: 5,
                    health: 100,
                    character: "character",
                    positionX: 100,
                    positionY: 200,
                    state: 0,
                };
            var enemy =
                {
                    idle: 0,
                    block: 0,
                    grab: 1,
                    attack: 2,
                    hurt: 3,
                    dead: 4,
                    jump: 5,
                    health: 100,
                    character: "character",
                    positionX: 400,
                    positionY: 200,
                    state: 0,
                };

            window.addEventListener("keydown", keydownHandler, false);
            window.addEventListener("keyup", keyupHandler, false);

            //renders the scene on each key up
            function keyupHandler()
            {
                //TODO update computer AI
                render();
            }
            
            //TODO make hitdetection for each character
            
            function keydownHandler(event)
            {
                //TODO character select
                if (gamePlaying == false)
                {
                    switch (event.keyCode) 
                    {
                        case 49: // 1
                            player.character = "Lucina";
                            break;
                        case 50: // 2
                            player.character = "Bowser";
                            break;
                        case 51: // 3
                            player.character = "Sheik";
                            break;
                        case 52: // 4
                            player.character = "Samus";
                            break;
                        default:
                            player.character = "";
                            break;
                    }
                    if (player.character != "")
                    {
                        //set player values
                        player.positionX = 100;
                        player.positionY = 250;
                        player.health = 100;
                        player.state = player.idle;
                        //set enemy values
                        //TODO math random number to change enemy character
                        enemy.character = "Bowser";
                        enemy.positionX = 400;
                        enemy.positionY = 250;
                        enemy.health = 100;
                        enemy.state = enemy.idle;

                        //start game
                        gamePlaying = true;
                    }
                    
                }
                //TODO player controls
                else
                {
                    switch (event.keyCode)
                    {
                        case 119: //w
                            break;
                        case 97: //a
                            break;
                        case 115: //s
                            break;
                        case 100: //d
                            break;
                        default:
                            break;
                    }
                }
               
            }

            function render()
            {
                //clear the page
                context.clearRect(0, 0, canvas.width, canvas.height);
               

                if (gamePlaying == true) {
                    //draw the background
                    context.drawImage(background, 0, 0);

                    //Draw the Player
                    //TODO make a switch case for each character to change their sprites to match their current action
                    //context.drawImage(lucinaImage, 0 /*(player1.state * Lucina.width)*/, 0, Lucina.width, Lucina.height,
                    //    player1._positionX, player1.positionY, Lucina.width, Lucina.height);
                    if (player.character == "Lucina") { context.drawImage(lucinaImage, (player.state * Lucina.width), 0, Lucina.width, Lucina.height, player.positionX, player.positionY, Lucina.width, Lucina.height); }
                    else if (player.character == "Bowser") { context.drawImage(bowserImage, (player.state * Bowser.width), 0, Bowser.width, Bowser.height, player.positionX, player.positionY, Bowser.width, Bowser.height); }
                    else if (player.character == "Sheik") { context.drawImage(sheikImage, (player.state * Sheik.width), 0, Sheik.width, Sheik.height, player.positionX, player.positionY, Sheik.width, Sheik.height); }
                    else { context.drawImage(samusImage, (player.state * Samus.width), 0, Samus.width, Samus.height, player.positionX, player.positionY, Samus.width, Samus.height); }
                    //Draw the Enemy
                    if (enemy.character == "Lucina") { context.drawImage(lucinaImage, 0, 0, Lucina.width, Lucina.height, enemy.positionX, enemy.positionY, Lucina.width, Lucina.height); }
                    else if (enemy.character == "Bowser") { context.drawImage(bowserImage, 0, 0, Bowser.width, Bowser.height, enemy.positionX, enemy.positionY, Bowser.width, Bowser.height); }
                    else if (enemy.character == "Sheik") { context.drawImage(sheikImage, 0, 0, Sheik.width, Sheik.height, enemy.positionX, enemy.positionY, Sheik.width, Sheik.height); }
                    else { context.drawImage(samusImage, 0, 0, Samus.width, Samus.height, enemy.positionX, enemy.positionY, Samus.width, Samus.height); }
                    //draw the health bars
                    context.fillStyle = "#000000";
                    context.fillRect(25, 25, 200, 20);
                    context.fillRect(325, 25, 200, 20);
                    //fill in the health
                    context.fillStyle = "#00FF19";
                    context.fillRect(25, 25, (2 * player.health), 20);
                    context.fillRect(325, 25, (2 * enemy.health), 20);
                }
                //else show character selection screen
                else
                {
                    //TODO show character image
                }
            }

        });
	</script>
</head>
<body>
	
	<canvas id="myCanvas" height="462" width="580"></canvas>

</body>
</html>